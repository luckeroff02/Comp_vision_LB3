# Comp_vision_LB3
Задача состоит в обнаружении движущегося объекта на видео с неподвижной камерой. Основные этапы:  
1. Предварительная обработка видео для улучшения распознавания
2. Создание маски фона
3. Наложение маски на кадры и выделение движущегося объекта
4. Обведение объекта рамкой
  
В данной работе будет использоваться следующее видео:
![first](https://github.com/luckeroff02/Comp_vision_LB3/blob/main/clear.gif)  
## Поиск объекта  
Для обработки кадров используются следующие методы OpenCV:  

Морфологические операции:  
- cv2.MORPH_OPEN (эрозия + дилатация) - подходит для темных объектов на светлом фоне
- cv2.MORPH_CLOSE (дилатация + эрозия) - для светлых объектов на темном фоне
- Фильтр Гаусса (cv2.GaussianBlur) - устраняет шумы и мелкие детали  

Для обработки видео используются:  
- cv2.VideoCapture - чтение видеофайла
- cap.read - получение кадров
- cv2.VideoWriter - запись результата  

Создание маски фона  
Функция cv2.createBackgroundSubtractorMOG2 анализирует последовательность кадров, определяя статичные пиксели как фон. Ключевые параметры:
- history - количество кадров для модели фона
- varThreshold - порог чувствительности (чем выше, тем меньше ложных срабатываний)
- detectShadows - обнаружение теней (в данном случае не требуется, так как у объекта нет теней, но есть светлые артефакты)  
Маска накладывается с помощью cv2.bitwise_and, которая сохраняет только совпадающие пиксели.   
![second](https://github.com/luckeroff02/Comp_vision_LB3/blob/main/grayscale.gif)  
## Выделение объекта  
После того, как объект определяется достаточно хорошо можно перейти к выделению его рамкой. Для этого также воспользуемся встроенными функциями:
- *cv2.findContours(masked_image, mode, method)* - находит контуры объектов на бинарном изображении. На вход подается обработанное изображение, метод поиска контуров (в нашем случае - *cv2.RETR_EXTERNAL* - поиск внешнего контура), метод аппроксимации контура (в нашем случае - *cv2.CHAIN_APPROX_SIMPLE* - упрощение контура до основных ключевых точек).
- *cv2.contourArea* - определяет площадь найденного ранее контура. Зададим минимальную площадь объекта - 500. Это необходимо для того, чтобы выделить один основной объект.
- *cv2.boundingRect* - вычисляет ограничивающий прямоугольник минимального размера вокруг контура.
- *cv2.rectangle* - рисует прямоугольник на изображении.

![third](https://github.com/luckeroff02/Comp_vision_LB3/blob/main/result.gif)  
